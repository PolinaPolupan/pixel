services:
  engine:
    build:
      context: ../engine
    ports:
      - '8080:8080'
    environment:
      APP_NAME: ${APP_NAME}
      STORAGE_DIRECTORY: ${LOCAL_RESOURCES_DIR}
      NODE_SERVICE_URL: ${NODE_SERVICE_URL}
      SPRING_PROFILES_ACTIVE: ${SPRING_PROFILES_ACTIVE}
    volumes:
      - ../pixel/resources:/app/pixel/resources
    depends_on:
      - node

  node:
    build:
      context: ../node
    ports:
      - "8000:8000"
    volumes:
      - ../pixel/execution_graph:/app/pixel/execution_graph
      - ../node/pixel:/app/pixel
    environment:
      ENGINE_SERVICE_URL: ${ENGINE_SERVICE_URL}
      EXECUTION_GRAPH_DIR: ${EXECUTION_GRAPH_DIR}

  frontend:
    build:
      context: ../frontend
    ports:
      - "5173:5173"
    volumes:
      - ../frontend/src:/app/src
    environment:
      NODE_ENV: development
    stdin_open: true
    tty: true
    command: npm run dev
